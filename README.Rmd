---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "50%",
  warning = FALSE,
  message = FALSE
)
```

# rusleR <img src="man/figures/logo.svg" align="right" height="139" />

<!-- badges: start -->
[![R-CMD-check](https://github.com/atsyplenkov/rusleR/workflows/R-CMD-check/badge.svg)](https://github.com/atsyplenkov/rusleR/actions)
[![CRAN_Status_Badge](https://www.r-pkg.org/badges/version/rusleR)](https://cran.r-project.org/package=rusleR)
[![Last-changedate](https://img.shields.io/badge/last%20change-`r gsub('-', '--', Sys.Date())`-yellowgreen.svg)](/commits/master)
[![lifecycle](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Project Status: Concept â€“ Minimal or no implementation has been done yet, or the repository is only intended to be a limited example, demo, or proof-of-concept.](https://www.repostatus.org/badges/latest/concept.svg)](https://www.repostatus.org/#concept)

<!-- badges: end -->

This package offers an `R` implementation of Universal Soil Loss Equation ([USLE](https://en.wikipedia.org/wiki/Universal_Soil_Loss_Equation)). You can find here a collection of functions to estimate main factors: R-factor, K-factor, LS-factor and C-factor. The package uses[ `terra`](https://github.com/rspatial/terra) and [`Rsagacmd`](https://github.com/stevenpawley/Rsagacmd/) in the background. [`SAGA GIS`](https://sourceforge.net/projects/saga-gis/) needs to be install on your machine as well. 

## Installation

You can install the development version of rusleR from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("atsyplenkov/rusleR")
```

## Example

```{r example}
library(rusleR)
## basic example code
```

### LS-factor
This is a basic example which shows you how to calculate LS_alpine ([Schmidt et al., 2019](https://www.sciencedirect.com/science/article/pii/S2215016119300056)):

```{r ls_alpine}
library(Rsagacmd)
library(terra)

# initiate a saga object
saga <- saga_gis(raster_backend = "terra")

# load DEM
f <- system.file("extdata/dem.tif", package="rusleR")
DEM <- rast(f)

# calculate LS-alpine
ls <- ls_alpine(dem = DEM)
```

As a result of `ls_alpine()` you receive a `SpatRaster` object:
```{r summary}
ls
```

```{r pressure, echo = FALSE}
plot(ls)
```

### R-factor
With the help of `get_glored()` function you can quickly download and crop to AOI a Global Rainfall Erosivity Database map ([GLORED](https://esdac.jrc.ec.europa.eu/content/global-rainfall-erosivity)). It was created by [*Panagos et al.* (2017)](https://www.nature.com/articles/s41598-017-04282-8) based on *in-situ* measurements from 3,625 stations. This GLORED was used to develop a global erosivity map at 30 arc-seconds(~1 km) based on a Gaussian Process Regression(GPR). 

```{r glored}

library(terra)

f <- system.file("extdata/extent.shp", package="rusleR")
v <- vect(f)

r_factor <- get_glored(v)

```

As a result of `get_glored()` you receive a `SpatRaster` object:
```{r summary_r}
r_factor
```

```{r r_plot, echo = FALSE}
plot(r_factor)
```

## To-do list
- [x] K-factor functions

- [] SDR estimation (see [Batista et al., 2021](https://www.sciencedirect.com/science/article/pii/S1364815221000049))

- [] Connectivity index (see [Borselli et al., 2008](https://www.sciencedirect.com/science/article/pii/S0341816208000982))

- [] IC by [Cavalli et al., 2013](https://www.sciencedirect.com/science/article/pii/S0169555X12002267)

- [] SDR by [Vigiak et al., 2012](https://www.sciencedirect.com/science/article/pii/S0169555X11004478)

- [] C-factor????
